import json
import requests
import numpy as np
from tensorflow.examples.tutorials.mnist import input_data

print("start")
mnist = input_data.read_data_sets("MNIST_data/", one_hot=True)
print("TESTING")
for i in range(1):
	print("ITERATION", (i + 1))
	#X = mnist.test.images[i:i + 1]
	X = [[255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,229,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,124,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,3,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,249,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,213,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,0,0,0,0,0,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,0,0,255,255,255,255,255,255,0,8,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,0,0,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,152,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,255,255,255,255,255,255,255,255,255,255,255,0,201,255,255,255,255,255,255,255,255,255,255,255,255,255,255,239,0,255,255,255,255,255,255,255,222,0,0,102,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,0,0,0,0,0,0,0,0,21,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255,255]]
	#y = mnist.test.labels[i:i + 1]
	data = "[";
	for x in X[0]:
		#data = data + str(int(255 - (float(x) * 255))).strip()
		data = data + str(int(x)).strip()
		data += ","
	data = data + "]"
	r = requests.post("http://127.0.0.1:8080/", data={'data':data})
	#for j in range(10):
	#	if y[0][j] == 1:
	#		print("Expected: ", j)
	print("Expected: ", 6)
	print("Result: ", r.content)

'''
print("_matrix_")
X = mnist.test.images[:1]
y = mnist.test.labels[:1]
print("result")
print(y)
print("shape")
print(np.shape(X))
print("Request")
data = "[";
for x in X[0]:
	data = data + str(int(255 - (float(x) * 255))).strip()
	data += ","
data = data + "]"
print("DATA")
print(data)
r = requests.post("http://127.0.0.1:8080/", data={'data':data})
#r = requests.get("http://127.0.0.1:8080/")
print("Status code")
print(r.status_code)
print("json")
print(r.json)
print("content")
print(r.content)
print("end")
'''
